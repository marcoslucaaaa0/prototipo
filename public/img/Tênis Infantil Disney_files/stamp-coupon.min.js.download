"use strict";!function(t){var e=t.freedom,o=window.freedom.nsPubSub||{},r=function(){try{var t=document.querySelector(".buy-button-now");return(t=t&&t.getAttribute("data-seller"))?+t:(t=document.querySelector("[product-data-seller]"),t=t&&t.getAttribute("product-data-seller"),t?+t:0)}catch(e){return console.error("call-to-action.getSeller",e),0}},u=function(){return e.nsStorage.get("cp_sku")||void 0},n=function(t,o,r){e.nsStorage.set(t,o,r)},a=function(){var t=document.querySelector("#buy-button-now");if(t){var o=t.getAttribute("data-sku"),n=o.split("-");n=n[0]+"-"+n[1]+"-"+n[2];var a=u(),c=r().toString(),d=document.querySelector("#stamp-coupon"),s=d&&d.getAttribute("data-discount"),l=document.querySelector("#stamp-coupon .text__stamp_coupon p");if(a&&o&&a.find(function(t){return t.skuFather===n&&t.sellerId===c})&&(e.addClass(d,"coupon-actived"),l.innerHTML=s+" de desconto aplicado"),e.addClass(d,"loaded"),d){var i={sku:o,skuFather:n,sellerId:c},p=JSON.parse(sessionStorage.getItem("cp_sku"))||[];p&&(p=p.filter(function(t){return t.sku!==o})),p.push(i),sessionStorage.setItem("cp_sku",JSON.stringify(p))}}},c=function(t){var o=document.querySelector("#buy-button-now"),r=o.getAttribute("data-sku"),a=r.split("-");a=a[0]+"-"+a[1]+"-"+a[2];var c=o.getAttribute("data-seller"),d=document.querySelector("#stamp-coupon"),s=d&&d.getAttribute("data-discount"),l=document.querySelector("#stamp-coupon .text__stamp_coupon p"),i={sku:r,skuFather:a,sellerId:c},p=u(),m=t&&t.target&&t.target.parentNode&&t.target.parentNode.parentNode?t.target.parentNode.parentNode:null;m&&e.addClass(m,"coupon-actived"),p||(p=[]);var g=p.find(function(t){return t.skuFather===i.skuFather});g||(p.push(i),n("cp_sku",p,1880),l.innerHTML=s+" de desconto aplicado",window.WansTools&&(window.WansTools.trackEvent("Produto","clique","aplicar_cupom_clicavel",1),window.WansTools.ecProduct("add")))},d=function(t){t.preventDefault(),o.pub("modal.toggle","stamp-coupon-modal",!0)};e.addEvent("load",t,a),e.live(".couponSku-readMore","click",d),e.live(".addCoupon-sku","click",c),e.live(".stamp-coupon-modal-close","click",function(){o.pub("modal.toggle","stamp-coupon-modal",!1)})}(window);
//# sourceMappingURL=../../../../../target/maps/_refactoring/_components/product/stamp-coupon/desktop/stamp-coupon.min.js.map
